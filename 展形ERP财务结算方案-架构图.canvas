{
	"nodes":[
		{"id":"core","type":"text","text":"# å±•å½¢ERPè´¢åŠ¡ç»“ç®—æ–¹æ¡ˆ\n\n**æ ¸å¿ƒç›®æ ‡**\nåœ¨å¤ç”¨ç°æœ‰ financial ä½“ç³»åŸºç¡€ä¸Šï¼Œæ‰©å±•æ”¯æŒé’¢æè´¸æ˜“å«èµ„ç»“ç®—åœºæ™¯\n\n**è®¾è®¡åŸåˆ™**\n- å¤ç”¨ç°æœ‰æ¶æ„\n- é…ç½®é©±åŠ¨\n- å…¬å¼å¿«ç…§å®¡è®¡\n- å‘åå…¼å®¹","x":0,"y":0,"width":400,"height":260,"color":"6"},
		{"id":"caliber-interest","type":"text","text":"## ğŸ’° å«èµ„åˆ©æ¯\n\n**å…¬å¼**\nåˆ©æ¯ = å«èµ„é‡‘é¢ Ã— å¹´åŒ–18% / 360 Ã— å¤©æ•°\n\n**å‚æ•°**\n- åŸºæ•°ï¼šå«ç¨é‡‘é¢\n- åˆ©ç‡ï¼š18%ï¼ˆè‡ªæœ‰èµ„é‡‘ï¼‰\n- è®¡æ¯ï¼šä»˜æ¬¾æ—¥â†’å›æ¬¾æ—¥","x":-600,"y":-300,"width":300,"height":220,"color":"3"},
		{"id":"caliber-channel","type":"text","text":"## ğŸš› é€šé“è´¹\n\n**å…¬å¼**\nå¤©æ•°â‰¤30: é€šé“è´¹=0\nå¤©æ•°>30: æ•°é‡Ã—(å¤©æ•°-30)Ã—0.5å…ƒ/å¨/å¤©\n\n**å‚æ•°**\n- å…è´¹æœŸï¼š30å¤©\n- å•ä»·ï¼š0.5å…ƒ/å¨/å¤©","x":-600,"y":-40,"width":300,"height":200,"color":"3"},
		{"id":"caliber-subsidy","type":"text","text":"## ğŸ¦ è´´æ¯\n\n**å…¬å¼**\nè´´æ¯ = æ±‡ç¥¨é‡‘é¢ Ã— 2.3% / 360 Ã— å¤©æ•°\n\n**å‚æ•°**\n- åŸºæ•°ï¼šæ±‡ç¥¨é‡‘é¢ï¼ˆå«ç¨ï¼‰\n- è´´æ¯ç‡ï¼š2.3%ï¼ˆå¹´åŒ–ï¼‰","x":-600,"y":200,"width":300,"height":180,"color":"3"},
		{"id":"caliber-logistics","type":"text","text":"## ğŸ“¦ ç‰©æµè´¹ç”¨\n\n**æ¨¡å¼**\næ‰‹å·¥å½•å…¥ï¼ˆç”¨æˆ·å¡«å•ä»·ï¼‰\n\n**ç±»å‹**\n- èˆ¹è¿è´¹ã€æ¸¯å£è´¹\n- ä»“å‚¨è´¹ã€åŠ å·¥è´¹\n- è£…å¸è´¹","x":-600,"y":420,"width":300,"height":180,"color":"3"},
		{"id":"db-expense","type":"text","text":"## ğŸ“‹ è´¹ç”¨æ˜ç»†è¡¨\n\n**financial_settlement_expense**\n\nä¸å•†å“æ˜ç»†å¹¶è¡Œï¼Œå­˜å‚¨ï¼š\n- è´¹ç”¨ç±»å‹ã€åç§°\n- æ•°é‡ã€å•ä»·ã€å¤©æ•°\n- é‡‘é¢ã€ç¨é¢\n- æ¥æºå•æ®\n- å…¬å¼å¿«ç…§\n\n**å”¯ä¸€é”®**\n- (pid, expense_type, seq_no)\n- (pid, expense_type, source_doc_id)","x":500,"y":320,"width":300,"height":280,"color":"5"},
		{"id":"db-config","type":"text","text":"## âš™ï¸ é…ç½®è¡¨\n\n**financial_expense_config**\n\nå­˜å‚¨è´¹ç‡å‚æ•°ï¼š\n- é…ç½®ç¼–ç ï¼ˆconfig_codeï¼‰\n- è´¹ç‡å€¼ï¼ˆrate_valueï¼‰\n- è®¡ç®—æ–¹å¼ï¼ˆcalc_methodï¼‰\n- é˜¶æ¢¯è§„åˆ™ï¼ˆtier_rulesï¼‰\n- é€‚ç”¨å•†æˆ·ã€æ—¶é—´æ®µ\n\n**å–å‚ä¼˜å…ˆçº§**\næŒ‡å®šå•†æˆ· > å…¨å±€ > å¼‚å¸¸","x":900,"y":-40,"width":300,"height":280,"color":"5"},
		{"id":"backend-entity","type":"text","text":"## ğŸ”§ Entityå±‚\n\n**æ‰©å±•**\n- FinancialSettlement.java\n\n**æ–°å¢**\n- FinancialSettlementExpense.java\n- FinancialExpenseConfig.java\n\n**è‡ªåŠ¨æ˜ å°„**\nEntity â†” Bo â†” Vo\n(@AutoMapper)","x":900,"y":280,"width":300,"height":220,"color":"1"},
		{"id":"backend-service","type":"text","text":"## âš¡ Serviceå±‚\n\n**æ ¸å¿ƒå¼•æ“**\nExpenseCalculationEngine\n- åˆ©æ¯è®¡ç®—\n- é€šé“è´¹è®¡ç®—\n- è´´æ¯è®¡ç®—\n- å…¬å¼å¿«ç…§ç”Ÿæˆ\n\n**æ‰©å±•æœåŠ¡**\nFinancialSettlementService\n- calculateAdvanceInterest\n- saveExpenseList\n- validateBeforeSubmit","x":1300,"y":-40,"width":300,"height":280,"color":"1"},
		{"id":"backend-controller","type":"text","text":"## ğŸŒ Controllerå±‚\n\n**æ–°å¢æ¥å£**\n\nPOST /calculateInterest\nè®¡ç®—åˆ©æ¯\n\nGET /{id}/expense\næŸ¥è¯¢è´¹ç”¨æ˜ç»†\n\nPOST /{id}/expense\nä¿å­˜è´¹ç”¨æ˜ç»†","x":1300,"y":280,"width":300,"height":220,"color":"1"},
		{"id":"snapshot","type":"text","text":"## ğŸ“ å…¬å¼å¿«ç…§\n\n**ç”¨é€”**\nå®¡è®¡è¿½æº¯ã€å‚æ•°é”å®š\n\n**æ ¼å¼**\nJSON (TEXTå­—æ®µ, max 10000å­—ç¬¦)\n\n**Schema v1.0**\n- ç»“ç®—å•çº§åˆ«ï¼ˆadvance, channelFee, subsidy, expenses, summaryï¼‰\n- è´¹ç”¨æ˜ç»†çº§åˆ«ï¼ˆæ¯æ¡è´¹ç”¨çš„è®¡ç®—å…¬å¼ï¼‰\n\n**æ ¡éªŒ**\næäº¤å®¡æ‰¹å‰å¿…é¡»ç”Ÿæˆ","x":1300,"y":540,"width":300,"height":280,"color":"2"},
		{"id":"workflow","type":"text","text":"## ğŸ”„ å®¡æ‰¹æµ\n\n**çŠ¶æ€æµè½¬**\nè‰ç¨¿(0) â†’ å¾…å®¡æ‰¹(1) â†’ å·²å®Œæˆ(2)\n         â†“é©³å›/æ’¤é”€\n       è‰ç¨¿(0)\n\n**æ ¡éªŒ**\n- æäº¤æ—¶ï¼šå¿…é¡»æœ‰å…¬å¼å¿«ç…§\n- å·²æäº¤ï¼šä¸å¯ç¼–è¾‘\n\n**ç›‘å¬**\n- æäº¤ï¼šé”å®šå¿«ç…§\n- å®Œæˆï¼šè§¦å‘åç»­ä¸šåŠ¡","x":1700,"y":-40,"width":300,"height":280,"color":"2"},
		{"id":"phase0","type":"text","text":"## Phase 0\nâš ï¸ å£å¾„å†»ç»“\n\n- å«èµ„åˆ©æ¯å£å¾„ç¡®è®¤ âœ…\n- é€šé“è´¹å£å¾„ç¡®è®¤ âœ…\n- è´´æ¯å£å¾„ç¡®è®¤ âœ…\n- ç‰©æµè´¹å£å¾„ç¡®è®¤ âœ…\n- ä¸ç°æœ‰è¡¨å…³ç³»ç¡®è®¤ âœ…","x":-600,"y":700,"width":250,"height":200,"color":"3"},
		{"id":"phase1","type":"text","text":"## Phase 1\nğŸ’¾ æ•°æ®åº“è¿ç§»\n\n- æ‰©å±•ä¸»è¡¨\n- æ–°å»ºè´¹ç”¨æ˜ç»†è¡¨\n- æ–°å»ºé…ç½®è¡¨\n- åˆå§‹åŒ–å­—å…¸\n- åˆå§‹åŒ–é»˜è®¤è´¹ç‡","x":-300,"y":700,"width":250,"height":200,"color":"5"},
		{"id":"phase2","type":"text","text":"## Phase 2\nğŸ”§ åç«¯å¼€å‘\n\n- Entity/Bo/Voæ‰©å±•\n- è®¡ç®—å¼•æ“å¼€å‘\n- Serviceå±‚æ‰©å±•\n- Controlleræ¥å£","x":0,"y":700,"width":250,"height":200,"color":"1"},
		{"id":"phase3","type":"text","text":"## Phase 3\nğŸ¨ å‰ç«¯å¼€å‘\n\n- æ–°å»ºç¼–è¾‘é¡µ\n- FlexEditå¸ƒå±€\n- APIæ‰©å±•\n- æƒé™é…ç½®","x":300,"y":700,"width":250,"height":200,"color":"1"},
		{"id":"phase4","type":"text","text":"## Phase 4\nğŸ”„ å®¡æ‰¹æµè”åŠ¨\n\n- æµç¨‹æäº¤æ ¡éªŒ\n- çŠ¶æ€æµè½¬éªŒè¯\n- å…¬å¼å¿«ç…§é”å®š","x":600,"y":700,"width":250,"height":200,"color":"2"},
		{"id":"phase5","type":"text","text":"## Phase 5\nâœ… æµ‹è¯•å›å½’\n\n**è®¡ç®—å‡†ç¡®æ€§**\n- åˆ©æ¯ã€é€šé“è´¹ã€è´´æ¯\n\n**è¾¹ç•Œæµ‹è¯•**\n- åŒæ—¥ã€é…ç½®ç¼ºå¤±\n\n**ç³»ç»Ÿæµ‹è¯•**\n- å¹¶å‘ã€å®¡æ‰¹æµã€ç§Ÿæˆ·éš”ç¦»","x":900,"y":700,"width":250,"height":200,"color":"4"},
		{"id":"principles","type":"text","text":"## ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™\n\n1ï¸âƒ£ å¤ç”¨ç°æœ‰æ¶æ„\nç»§æ‰¿ BaseBill/BaseDoc\næœ€å°åŒ–æ”¹åŠ¨\n\n2ï¸âƒ£ é…ç½®é©±åŠ¨\nè´¹ç‡å‚æ•°è¡¨é…ç½®\næ”¯æŒæŒ‰å•†æˆ·/æ—¶é—´æ®µè°ƒæ•´\n\n3ï¸âƒ£ å…¬å¼å¿«ç…§å®¡è®¡\nJSONæ ¼å¼å­˜å‚¨è®¡ç®—è¿‡ç¨‹\nä¾¿äºè¿½æº¯å’ŒéªŒè¯\n\n4ï¸âƒ£ å‘åå…¼å®¹\næ—§æ•°æ®ä¿æŒä¸å˜\nå¯é€‰è¿ç§»\n\n5ï¸âƒ£ èŒè´£åˆ†ç¦»\nå•†å“æ˜ç»† vs è´¹ç”¨æ˜ç»†\nç‹¬ç«‹ç®¡ç†","x":-250,"y":320,"width":350,"height":340,"color":"6"},
		{"id":"arch-existing","type":"text","text":"## ğŸ—ï¸ ç°æœ‰æ¶æ„\n\n**ç»§æ‰¿é“¾**\nFinancialSettlement\nâ†’ BaseFinancialSettlement\nâ†’ BaseBill\nâ†’ BaseDoc\nâ†’ BaseEntity\n\n**å¤ç”¨å­—æ®µ**\n- otherExpensesAmount\n- prepayAmount\n- actualAmount","x":650,"y":-1200,"width":300,"height":260,"color":"4"},
		{"id":"db-main","type":"text","text":"## ğŸ’¾ ä¸»è¡¨æ‰©å±•\n\n**financial_settlement**\n\næ–°å¢12ä¸ªå­—æ®µï¼š\n- advance_type å«èµ„ç±»å‹\n- advance_amount å«èµ„é‡‘é¢\n- advance_start_date è®¡æ¯å¼€å§‹\n- advance_end_date è®¡æ¯ç»“æŸ\n- advance_days å«èµ„å¤©æ•°\n- interest_amount åˆ©æ¯é‡‘é¢\n- channel_fee_amount é€šé“è´¹\n- subsidy_amount è´´æ¯\n- formula_snapshot å…¬å¼å¿«ç…§\n- total_expense_amount è´¹ç”¨åˆè®¡","x":480,"y":-120,"width":300,"height":320,"color":"5"}
	],
	"edges":[
		{"id":"edge-core-interest","fromNode":"core","fromSide":"left","toNode":"caliber-interest","toSide":"right","label":"ä¸šåŠ¡å£å¾„"},
		{"id":"edge-core-channel","fromNode":"core","fromSide":"left","toNode":"caliber-channel","toSide":"right"},
		{"id":"edge-core-subsidy","fromNode":"core","fromSide":"left","toNode":"caliber-subsidy","toSide":"right"},
		{"id":"edge-core-logistics","fromNode":"core","fromSide":"left","toNode":"caliber-logistics","toSide":"right"},
		{"id":"edge-core-arch","fromNode":"core","fromSide":"right","toNode":"arch-existing","toSide":"left","label":"æŠ€æœ¯æ¶æ„"},
		{"id":"edge-arch-db","fromNode":"arch-existing","fromSide":"bottom","toNode":"db-main","toSide":"top","label":"æ‰©å±•"},
		{"id":"edge-db-main-expense","fromNode":"db-main","fromSide":"bottom","toNode":"db-expense","toSide":"top","label":"å¹¶è¡Œ"},
		{"id":"edge-db-main-config","fromNode":"db-main","fromSide":"right","toNode":"db-config","toSide":"left","label":"å–å‚"},
		{"id":"edge-db-expense-entity","fromNode":"db-expense","fromSide":"right","toNode":"backend-entity","toSide":"left","label":"æ˜ å°„"},
		{"id":"edge-db-config-service","fromNode":"db-config","fromSide":"bottom","toNode":"backend-service","toSide":"left","label":"è®¡ç®—"},
		{"id":"edge-entity-service","fromNode":"backend-entity","fromSide":"top","toNode":"backend-service","toSide":"bottom"},
		{"id":"edge-service-controller","fromNode":"backend-service","fromSide":"bottom","toNode":"backend-controller","toSide":"top"},
		{"id":"edge-service-snapshot","fromNode":"backend-service","fromSide":"bottom","toNode":"snapshot","toSide":"left","label":"ç”Ÿæˆ"},
		{"id":"edge-snapshot-workflow","fromNode":"snapshot","fromSide":"top","toNode":"workflow","toSide":"bottom","label":"æ ¡éªŒ"},
		{"id":"edge-phase0-1","fromNode":"phase0","fromSide":"right","toNode":"phase1","toSide":"left"},
		{"id":"edge-phase1-2","fromNode":"phase1","fromSide":"right","toNode":"phase2","toSide":"left"},
		{"id":"edge-phase2-3","fromNode":"phase2","fromSide":"right","toNode":"phase3","toSide":"left"},
		{"id":"edge-phase3-4","fromNode":"phase3","fromSide":"right","toNode":"phase4","toSide":"left"},
		{"id":"edge-phase4-5","fromNode":"phase4","fromSide":"right","toNode":"phase5","toSide":"left"},
		{"id":"edge-core-principles","fromNode":"core","fromSide":"bottom","toNode":"principles","toSide":"top","label":"æŒ‡å¯¼"},
		{"id":"edge-caliber-phase0","fromNode":"caliber-interest","fromSide":"bottom","toNode":"phase0","toSide":"top","label":"å†»ç»“"}
	]
}